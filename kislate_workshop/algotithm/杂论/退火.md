# æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆSimulated Annealingï¼‰è¯¦è§£åŠåœ¨ç»„åˆä¼˜åŒ–é—®é¢˜ä¸­çš„åº”ç”¨

---

## ğŸ§  ä¸€ã€æ¨¡æ‹Ÿé€€ç«ç®—æ³•ç®€ä»‹

æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆ**Simulated Annealing, SA**ï¼‰æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡çš„å…ƒå¯å‘å¼ä¼˜åŒ–ç®—æ³•ï¼Œå¹¿æ³›åº”ç”¨äºè§£å†³å¤æ‚çš„**ç»„åˆä¼˜åŒ–é—®é¢˜**ã€‚å®ƒæ¨¡æ‹Ÿäº†ç‰©ç†ä¸­å›ºä½“é€€ç«çš„è¿‡ç¨‹ï¼šå°†å›ºä½“åŠ çƒ­åˆ°é«˜æ¸©åç¼“æ…¢å†·å´ï¼Œä½¿å…¶è¾¾åˆ°èƒ½é‡æœ€ä½ã€ç»“æ„æœ€ç¨³å®šçš„ç†æƒ³çŠ¶æ€ ã€‚

åœ¨ç®—æ³•ä¸­ï¼Œè¿™ä¸€è¿‡ç¨‹è¢«æŠ½è±¡ä¸ºï¼š

- åˆå§‹è§£å¯¹åº”â€œé«˜æ¸©â€ä¸‹çš„æ— åºçŠ¶æ€ï¼›
- éšç€â€œæ¸©åº¦â€é€æ¸ä¸‹é™ï¼Œç®—æ³•é€æ­¥æ”¶æ•›äºä¸€ä¸ªæ›´ä¼˜ç”šè‡³å…¨å±€æœ€ä¼˜è§£ã€‚

SA çš„æ ¸å¿ƒæ€æƒ³æ˜¯å…è®¸åœ¨ä¸€å®šæ¦‚ç‡ä¸‹æ¥å—è¾ƒå·®çš„è§£ï¼Œä»è€Œé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ ã€‚

---

## ğŸ” äºŒã€æ¨¡æ‹Ÿé€€ç«çš„åŸºæœ¬æµç¨‹

### 1. åˆå§‹åŒ–é˜¶æ®µ
- é€‰æ‹©ä¸€ä¸ªåˆå§‹è§£ $ s_0 $
- è®¾ç½®åˆå§‹æ¸©åº¦ $ T_0 $ï¼ˆé€šå¸¸è¾ƒå¤§ï¼‰
- è®¾ç½®é™æ¸©é€Ÿç‡ $ \alpha $ï¼ˆå¦‚ 0.95~0.99ï¼‰
- è®¾ç½®è¿­ä»£æ¬¡æ•°æˆ–ç»ˆæ­¢æ¸©åº¦

### 2. è¿­ä»£æ›´æ–°é˜¶æ®µ
- åœ¨å½“å‰è§£ $ s $ çš„é‚»åŸŸä¸­ç”Ÿæˆæ–°è§£ $ s' $
- è®¡ç®—ç›®æ ‡å‡½æ•°å·® $ \Delta E = f(s') - f(s) $
- å¦‚æœ $ \Delta E < 0 $ï¼Œå³æ–°è§£æ›´å¥½ï¼Œåˆ™æ¥å— $ s' $
- å¦åˆ™ä»¥æ¦‚ç‡ $ P = \exp(-\Delta E / T) $ æ¥å—è¾ƒå·®è§£
- æ›´æ–°å½“å‰è§£ $ s = s' $ï¼Œå¹¶é™ä½æ¸©åº¦ $ T = \alpha \cdot T $

### 3. ç»ˆæ­¢æ¡ä»¶
- æ¸©åº¦é™åˆ°æŸä¸ªæå°å€¼
- è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°
- è§£ä¸å†æ˜æ˜¾å˜åŒ–

---

## ğŸ“Œ ä¸‰ã€æ¨¡æ‹Ÿé€€ç«çš„ç‰¹ç‚¹ä¸ä¼˜åŠ¿

| ç‰¹ç‚¹ | è¯´æ˜ |
|------|------|
| è·³å‡ºå±€éƒ¨æœ€ä¼˜ | é€šè¿‡æ¦‚ç‡æ¥å—åŠ£è§£ï¼Œèƒ½è·³å‡ºå±€éƒ¨æœ€ä¼˜é™·é˜±  |
| ç®—æ³•é€šç”¨æ€§å¼º | å¯ç”¨äºå„ç§ç»„åˆä¼˜åŒ–é—®é¢˜ï¼Œå¦‚TSPã€è£…ç®±ã€è°ƒåº¦ç­‰  |
| å‚æ•°æ˜“è°ƒ | æ¸©åº¦ä¸‹é™æ–¹å¼ã€åˆå§‹æ¸©åº¦ã€è¿­ä»£æ¬¡æ•°ç­‰å‚æ•°è°ƒèŠ‚ç®€å• |
| å¤šç”¨é€” | å¯æ‰©å±•ç”¨äºæœºå™¨å­¦ä¹ ã€è·¯å¾„è§„åˆ’ç­‰é¢†åŸŸ |

---

## ğŸ¯ å››ã€æ¨¡æ‹Ÿé€€ç«åœ¨ç»„åˆä¼˜åŒ–é—®é¢˜ä¸­çš„åº”ç”¨

æ¨¡æ‹Ÿé€€ç«éå¸¸é€‚åˆç”¨äºè§£å†³ä»¥ä¸‹ç±»å‹çš„ç»„åˆä¼˜åŒ–é—®é¢˜ï¼š

- **æ—…è¡Œå•†é—®é¢˜ï¼ˆTSPï¼‰**
- **å›¾ç€è‰²é—®é¢˜**
- **è£…ç®±é—®é¢˜**
- **ä»»åŠ¡è°ƒåº¦é—®é¢˜**
- **åˆ†ç»„è¿‡æ¡¥é—®é¢˜ï¼ˆå¦‚ä½ ä¹‹å‰æåˆ°çš„é—®é¢˜ï¼‰**

ä¾‹å¦‚ï¼Œåœ¨â€œåˆ†ç»„è¿‡æ¡¥â€é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªäººåˆ†é…åˆ°ä¸åŒçš„æ‰¹æ¬¡ä¸­ï¼Œå¹¶å°è¯•æœ€å°åŒ–æ€»æ—¶é—´ã€‚ç”±äºè¯¥é—®é¢˜å…·æœ‰å¤§é‡çš„å¯èƒ½ç»„åˆï¼Œè´ªå¿ƒç­–ç•¥å®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œè€Œæ¨¡æ‹Ÿé€€ç«å¯ä»¥é€šè¿‡éšæœºæ‰°åŠ¨å’Œæ¥å—åŠ£è§£çš„æ–¹å¼ï¼Œæ¢ç´¢æ›´å¤šè§£ç©ºé—´ ã€‚

---

## ğŸ§ª äº”ã€æ¨¡æ‹Ÿé€€ç«åº”ç”¨äºâ€œåˆ†ç»„è¿‡æ¡¥â€é—®é¢˜

### 1. é—®é¢˜æè¿°å›é¡¾

> ä¸€ç¾¤äººéœ€è¦è¿‡æ¡¥ï¼Œæ¯æ¬¡æœ€å¤šä¸€æ‰¹äººä¸€èµ·èµ°ï¼Œæ¯æ‰¹äººçš„æ€»é‡é‡ä¸èƒ½è¶…è¿‡æ¡¥çš„æœ€å¤§æ‰¿é‡ã€‚æ¯æ‰¹çš„æ—¶é—´ç­‰äºè¯¥æ‰¹ä¸­æœ€æ…¢çš„äººçš„æ—¶é—´ã€‚ç›®æ ‡æ˜¯æœ€å°åŒ–æ‰€æœ‰æ‰¹æ¬¡çš„æ€»æ—¶é—´ã€‚

è¾“å…¥æ ¼å¼ï¼š
- ç¬¬ä¸€è¡Œä¸¤ä¸ªæ•´æ•° `W`ï¼ˆæ¡¥çš„æ‰¿é‡ï¼‰ã€`n`ï¼ˆäººæ•°ï¼‰
- æ¥ä¸‹æ¥ $n$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $t_i $ å’Œ $w_i$ï¼Œåˆ†åˆ«è¡¨ç¤ºç¬¬ i ä¸ªäººçš„è¿‡æ¡¥æ—¶é—´å’Œä½“é‡

è¾“å‡ºæ ¼å¼ï¼š
- è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€å°‘çš„è¿‡æ¡¥æ—¶é—´

---

### 2. ä½¿ç”¨æ¨¡æ‹Ÿé€€ç«çš„æ€è·¯

#### âœ… (1) è§£çš„è¡¨ç¤º

æˆ‘ä»¬ç”¨ä¸€ä¸ªæ’åˆ—æ¥è¡¨ç¤ºå½“å‰è§£ï¼Œå³æ‰€æœ‰äººçš„é¡ºåºï¼š

```cpp
vector<int> order; // è¡¨ç¤ºäººå‘˜é¡ºåºï¼Œä¾‹å¦‚ [0,2,1,3]
```

ç„¶åæ ¹æ®è¿™ä¸ªé¡ºåºè¿›è¡Œåˆ†ç»„ï¼ˆä»å‰å¾€åå°½å¯èƒ½å¤šè£…ï¼‰ã€‚

#### âœ… (2) ç›®æ ‡å‡½æ•°ï¼ˆèƒ½é‡å‡½æ•°ï¼‰

è®¡ç®—å½“å‰åˆ†ç»„æ–¹æ¡ˆçš„æ€»æ—¶é—´ï¼š

```cpp
double calc_cost(const vector<Person>& people, const vector<int>& order, int W) {
    double cost = 0;
    for (int i = 0; i < n; ) {
        int j = i;
        int tw = 0, tt = 0;
        while (j < n && tw + people[order[j]].weight <= W) {
            tw += people[order[j]].weight;
            tt = max(tt, people[order[j]].time);
            j++;
        }
        cost += tt;
        i = j;
    }
    return cost;
}
```

#### âœ… (3) é‚»åŸŸæ“ä½œï¼ˆNeighbor Generationï¼‰

å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼è¿›è¡Œæ‰°åŠ¨ï¼š

- éšæœºäº¤æ¢ä¸¤ä¸ªä½ç½®çš„äºº
- éšæœºåè½¬ä¸€æ®µå­åºåˆ—
- éšæœºæ’å…¥ä¸€ä¸ªäººåˆ°å¦ä¸€ä¸ªä½ç½®

```cpp
vector<int> generate_neighbor(vector<int> order) {
    int n = order.size();
    int i = rand() % n, j = rand() % n;
    swap(order[i], order[j]);
    return order;
}
```

#### âœ… (4) Metropolis å‡†åˆ™

åˆ¤æ–­æ˜¯å¦æ¥å—æ–°è§£ï¼š

```cpp
if (E_new < E_old || rand() < exp(-(E_new - E_old)/T)) {
    accept new solution
}
```

---

## ğŸ§° å…­ã€C++ ç¤ºä¾‹ä»£ç æ¡†æ¶

```cpp
#include <bits/stdc++.h>
using namespace std;

struct Person {
    int time, weight;
};

// ç”Ÿæˆé‚»åŸŸè§£ï¼ˆäº¤æ¢ä¸¤ä¸ªå…ƒç´ ï¼‰
vector<int> generate_neighbor(vector<int> order) {
    int n = order.size();
    int i = rand() % n, j = rand() % n;
    swap(order[i], order[j]);
    return order;
}

// è®¡ç®—å½“å‰è§£çš„æ€»æ—¶é—´
double calc_cost(const vector<Person>& people, const vector<int>& order, int W) {
    int n = people.size();
    double cost = 0;
    for (int i = 0; i < n; ) {
        int j = i;
        int tw = 0, tt = 0;
        while (j < n && tw + people[order[j]].weight <= W) {
            tw += people[order[j]].weight;
            tt = max(tt, people[order[j]].time);
            j++;
        }
        cost += tt;
        i = j;
    }
    return cost;
}

// æ¨¡æ‹Ÿé€€ç«ä¸»å‡½æ•°
vector<int> simulated_annealing(const vector<Person>& people, int W) {
    int n = people.size();
    vector<int> current(n), best(n);
    iota(current.begin(), current.end(), 0); // åˆå§‹é¡ºåºä¸º 0,1,...,n-1
    best = current;

    double T = 1e4;          // åˆå§‹æ¸©åº¦
    double alpha = 0.99;     // é™æ¸©ç³»æ•°
    int iterations = 10000;  // è¿­ä»£æ¬¡æ•°

    for (int iter = 0; iter < iterations; ++iter) {
        vector<int> next = generate_neighbor(current);
        double e1 = calc_cost(people, current, W);
        double e2 = calc_cost(people, next, W);

        if (e2 < e1 || (rand() / (double)RAND_MAX < exp(-(e2 - e1) / T))) {
            current = next;
            if (calc_cost(people, current, W) < calc_cost(people, best, W)) {
                best = current;
            }
        }
        T *= alpha;
    }

    return best;
}
```
---

å¦å¤–ä¸€ä¸ªæ´›è°·è§£æ³•, å¯ä»¥è¯¦è§:[éšæœºè´ªå¿ƒå·é¸¡æ³•ä»£ç è¯¦è§£](./éšæœºè´ªå¿ƒå·é¸¡.md)

---

## ğŸ” ä¸ƒã€ä¸è´ªå¿ƒç­–ç•¥çš„å¯¹æ¯”

| æ–¹æ³• | æ˜¯å¦æ¨è | é€‚ç”¨èŒƒå›´ | å¤‡æ³¨ |
|------|-----------|------------|------|
| è´ªå¿ƒç­–ç•¥ | âœ… æ¨è | å¿«é€Ÿå®ç°ã€å¤šæ•°æƒ…å†µä¸é”™ | æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ |
| æ¨¡æ‹Ÿé€€ç« | âœ… æ¨è | ä¸­å°è§„æ¨¡ç»„åˆä¼˜åŒ–é—®é¢˜ | å¯è·³è„±å±€éƒ¨æœ€ä¼˜ |
| çŠ¶å‹ DP | âœ… æ¨è | n â‰¤ 20 | å¯æ±‚æœ€ä¼˜è§£ |

---

## ğŸ“Œ å…«ã€å‚è€ƒèµ„æ–™

- [æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆSimulated Annealingï¼‰](https://en.wikipedia.org/wiki/Simulated_annealing)
- [æ¨¡æ‹Ÿé€€ç«ç®—æ³•â€”â€”ç»„åˆä¼˜åŒ–è½¬è½½ - CSDNåšå®¢](https://blog.csdn.net/weixin_43868320/article/details/122951709) 
- [å•äº²é—ä¼ æ¨¡æ‹Ÿé€€ç«åŠåœ¨ç»„åˆä¼˜åŒ–é—®é¢˜ä¸­çš„åº”ç”¨ - åŒ—äº¬é‚®ç”µå¤§å­¦å­¦æŠ¥](https://kns.cnki.net/KCMS/detail/detail.aspx?dbcode=CJFD&dbname=CJFDLAST2010&filename=BJYD201002015&uniplatform=NZKPT&v=MTEyMDF8TVp3cGxKZVpxRmlBWmxxQlFadWhQTHJPeFNNcm85RVlrak1XTmxRMm1qckU5TWJKSFZITG1GaXIrZEZGeHJOV2I=) 
- [æ¨¡æ‹Ÿé€€ç«ç®—æ³•åœ¨æ±‚è§£ç»„åˆä¼˜åŒ–é—®é¢˜ä¸­çš„åº”ç”¨ç ”ç©¶ - ç»´æ™®æœŸåˆŠå®˜ç½‘](https://www.cqvip.com/Qikan/ArticleDetail.aspx?id=30381841) 

---

## ğŸ“¬ ä¹ã€æ‹“å±•å»ºè®®

å¦‚æœä½ æƒ³æˆ‘å¸®ä½ å®Œæˆä»¥ä¸‹å†…å®¹ï¼š

- æŠŠä½ çš„è´ªå¿ƒç®—æ³•æ”¹æˆæ¨¡æ‹Ÿé€€ç«ç‰ˆæœ¬
- åŠ ä¸Šè¯¦ç»†æ³¨é‡Š
- æ”¯æŒè·¯å¾„è®°å½•ã€è°ƒè¯•è¾“å‡º
- æˆ–è€…å˜æˆ Python ç‰ˆæœ¬

æ¬¢è¿ç»§ç»­æé—® ğŸ˜Š