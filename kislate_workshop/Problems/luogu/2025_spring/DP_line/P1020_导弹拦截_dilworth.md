# P1020 [NOIP 1999 æé«˜ç»„] å¯¼å¼¹æ‹¦æˆª

## é¢˜ç›®æè¿°

æŸå›½ä¸ºäº†é˜²å¾¡æ•Œå›½çš„å¯¼å¼¹è¢­å‡»ï¼Œå‘å±•å‡ºä¸€ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿã€‚ä½†æ˜¯è¿™ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿæœ‰ä¸€ä¸ªç¼ºé™·ï¼šè™½ç„¶å®ƒçš„ç¬¬ä¸€å‘ç‚®å¼¹èƒ½å¤Ÿåˆ°è¾¾ä»»æ„çš„é«˜åº¦ï¼Œä½†æ˜¯ä»¥åæ¯ä¸€å‘ç‚®å¼¹éƒ½ä¸èƒ½é«˜äºå‰ä¸€å‘çš„é«˜åº¦ã€‚æŸå¤©ï¼Œé›·è¾¾æ•æ‰åˆ°æ•Œå›½çš„å¯¼å¼¹æ¥è¢­ã€‚ç”±äºè¯¥ç³»ç»Ÿè¿˜åœ¨è¯•ç”¨é˜¶æ®µï¼Œæ‰€ä»¥åªæœ‰ä¸€å¥—ç³»ç»Ÿï¼Œå› æ­¤æœ‰å¯èƒ½ä¸èƒ½æ‹¦æˆªæ‰€æœ‰çš„å¯¼å¼¹ã€‚

   
è¾“å…¥å¯¼å¼¹ä¾æ¬¡é£æ¥çš„é«˜åº¦ï¼Œè®¡ç®—è¿™å¥—ç³»ç»Ÿæœ€å¤šèƒ½æ‹¦æˆªå¤šå°‘å¯¼å¼¹ï¼Œå¦‚æœè¦æ‹¦æˆªæ‰€æœ‰å¯¼å¼¹æœ€å°‘è¦é…å¤‡å¤šå°‘å¥—è¿™ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿã€‚

## è¾“å…¥æ ¼å¼

ä¸€è¡Œï¼Œè‹¥å¹²ä¸ªæ•´æ•°ï¼Œä¸­é—´ç”±ç©ºæ ¼éš”å¼€ã€‚

## è¾“å‡ºæ ¼å¼

ä¸¤è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ•´æ•°ï¼Œç¬¬ä¸€ä¸ªæ•°å­—è¡¨ç¤ºè¿™å¥—ç³»ç»Ÿæœ€å¤šèƒ½æ‹¦æˆªå¤šå°‘å¯¼å¼¹ï¼Œç¬¬äºŒä¸ªæ•°å­—è¡¨ç¤ºå¦‚æœè¦æ‹¦æˆªæ‰€æœ‰å¯¼å¼¹æœ€å°‘è¦é…å¤‡å¤šå°‘å¥—è¿™ç§å¯¼å¼¹æ‹¦æˆªç³»ç»Ÿã€‚

## è¾“å…¥è¾“å‡ºæ ·ä¾‹ #1

### è¾“å…¥ #1

```
389 207 155 300 299 170 158 65
```

### è¾“å‡º #1

```
6
2
```

## è¯´æ˜/æç¤º

å¯¹äºå‰ $50\%$ æ•°æ®ï¼ˆNOIP åŸé¢˜æ•°æ®ï¼‰ï¼Œæ»¡è¶³å¯¼å¼¹çš„ä¸ªæ•°ä¸è¶…è¿‡ $10^4$ ä¸ªã€‚è¯¥éƒ¨åˆ†æ•°æ®æ€»åˆ†å…± $100$ åˆ†ã€‚å¯ä½¿ç”¨$\mathcal O(n^2)$ åšæ³•é€šè¿‡ã€‚  
å¯¹äºå $50\%$ çš„æ•°æ®ï¼Œæ»¡è¶³å¯¼å¼¹çš„ä¸ªæ•°ä¸è¶…è¿‡ $10^5$ ä¸ªã€‚è¯¥éƒ¨åˆ†æ•°æ®æ€»åˆ†ä¹Ÿä¸º $100$ åˆ†ã€‚è¯·ä½¿ç”¨ $\mathcal O(n\log n)$ åšæ³•é€šè¿‡ã€‚

å¯¹äºå…¨éƒ¨æ•°æ®ï¼Œæ»¡è¶³å¯¼å¼¹çš„é«˜åº¦ä¸ºæ­£æ•´æ•°ï¼Œä¸”ä¸è¶…è¿‡ $5\times 10^4$ã€‚


æ­¤å¤–æœ¬é¢˜å¼€å¯ spjï¼Œæ¯ç‚¹ä¸¤é—®ï¼ŒæŒ‰é—®ç»™åˆ†ã€‚

NOIP1999 æé«˜ç»„ ç¬¬ä¸€é¢˜

---

$\text{upd 2022.8.24}$ï¼šæ–°å¢åŠ ä¸€ç»„ Hack æ•°æ®ã€‚
##  ä¸‹é¢æ˜¯æˆ‘çš„å°è¯•ä»£ç ,(æœ€ç»ˆç‰ˆ, æ—¶é—´å¤æ‚åº¦è¶…äº†
ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é¢˜è§£ğŸ”—https://www.luogu.com.cn/article/yc19s69p
```cpp
// è¿™é‡Œæ˜¯æ²¡æœ‰dfsçš„è®¡ç®—
#include <bits/stdc++.h>
using namespace std;
int main(void) 
{
    // input
    string line;
    getline(cin, line);
    istringstream iss(line);
    int height;
    vector<int> heights;
    while(iss >> height) heights.push_back(height);
    // 

    int n = heights.size();// é•¿åº¦
    vector<int> dp(n, 1);
    vector<int> dp2(n, 1);
    int ans = 0;
    int cnt = 0;
    for(int i = n-1; i >= 0; i--)// ä»åå¾€å‰éå†
    {
        for(int j = i + 1; j < n; j++)// å‘åæ‰¾æœ€ä¼˜è§£
        {
            if(heights[j] <= heights[i]) dp[i] = max(dp[i], dp[j] + 1);
            else if(heights[j] > heights[i]) dp2[i] = max(dp2[i], dp2[j] + 1);
        }
        //dp[i] = max(dp[i], dp[j] + 1);
        ans = max(ans, dp[i]);
        cnt = max(cnt, dp2[i]);
    }
    
    cout << ans << endl;
    cout << cnt << endl;
    //for(int i = 0; i < n; i++) cout << dp[i] << " ";
    //cout << endl;
    return 0;
}
```

### `deepseek`çš„æ­£ç»å†™æ³•:
#### æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ€§è´¨:
- é•¿åº¦ä¸º$x$çš„åºåˆ—çš„æœ€å¤§æœ«å°¾é¡¹$f_x$æ˜¯å•è°ƒä¸å¢çš„
- æ¯æ¬¡æ’å…¥çš„å…ƒç´ éƒ½æ¯”ä»¥$j$ä¸ºç»“å°¾çš„é•¿åº¦ä¸ºxçš„$dp$åºåˆ—,çš„æœ€å¤§æœ«å°¾é¡¹$f_x$å°($dp$, å°±æ˜¯æœ€ä¼˜è§£)
- æ‰€ä»¥æ¯æ¬¡åœ¨`tail`ä¸­æ‰¾å°½å¯èƒ½å°çš„$f_x$
- æ‰¾åˆ°äº†çš„è¯å°±æ˜¯$f_{x+1}$ çš„æœ€å¤§å°±æ˜¯å®ƒäº†, å› ä¸ºä¸Šä¸€æ¡æ»¡è¶³äº†åŸæ¥çš„$f_{x+1}$ æ˜¯æ¯”å…¶å°çš„
- è¿™ä¸ªæ–¹æ³•æ˜¯ä»ä¸Šé¢çš„æ–¹æ³•æ¼”åŒ–è€Œæ¥çš„;
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    string line;
    getline(cin, line);
    istringstream iss(line);
    int height;
    vector<int> heights;
    while (iss >> height) heights.push_back(height);
    int n = heights.size();

    // è®¡ç®—æœ€é•¿ä¸ä¸Šå‡å­åºåˆ—ï¼ˆNon-Increasingï¼‰
    vector<int> tail1;
    for (int num : heights) {
        auto it = upper_bound(tail1.begin(), tail1.end(), num, greater<int>());
        if (it == tail1.end()) {
            tail1.push_back(num);
        } else {
            *it = num;
        }// ä¿è¯äº†æ¯ä¸€é¡¹å°½å¯èƒ½åœ°å¤§, æ–¹ä¾¿åç»­ç»§ç»­æ’å…¥, ä¸¥æ ¼è¯æ˜æŸ¥çœ‹luoguåˆ†æ
    }
    int ans1 = tail1.size();

    // è®¡ç®—æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼ˆIncreasingï¼‰
    vector<int> tail2;
    for (int num : heights) {
        auto it = lower_bound(tail2.begin(), tail2.end(), num);
        if (it == tail2.end()) {
            tail2.push_back(num);
        } else {
            *it = num;
        }
    }
    int ans2 = tail2.size();

    cout << ans1 << endl;
    cout << ans2 << endl;

    return 0;
}
```